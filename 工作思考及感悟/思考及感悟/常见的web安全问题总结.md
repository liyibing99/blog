# 常见的web安全问题总结

`年底了总结下web安全对于web前端从事人员也是一个特别重要的一个知识点，也是面试的时候，面试官经常问的安全前端问题。掌握一些web安全知识，提供安全防范意识，今天就会从几个方面说起前端web攻击和防御的常用手段 `

## XSS

XSS（Cross Site Scripting）跨站脚本攻击，因为缩写和css重叠，所以能叫XSS，跨脚本攻击是指通过存在安全漏洞的web网站注册用户的浏览器内非法的非本站点HTML标签或javascript进行一种攻击。

跨站脚本攻击有可能造成以下影响

1. 利用虚假输入表单骗取用户个人信息
2. 利用脚本窃取用户的cookie值，被害者在不知情况的下，帮助攻击者发送恶意请求
3. 显示伪造的文章活图片

XSS攻击分类：

* 反射型 -url参数直接注入

```
普通 http://localhost:3000/?form-china  
alert尝试 http://localhost:3000/?form=<scrupt>slert(1)</script> 如果有弹出，说明网站有漏洞，黑客就可以对网站发送攻击
```

* 获取cookie

通过访问你的网址，在url参数攻击，获取到cookie域名伪造 https://dwz.cn/ 用盗取的网址，修改一个简易的网址，发送攻击，也能访问，信息也能保存，又称伪装型网站
伪造cookie入侵， 存储型 存储到DB后读取注入

跨脚本注入，通过脚本注入代码。用户比如发送评论，用户的信息都会在黑客网站显示，就可以拿到你所需要的数据

XSS攻击的危害-Scripting能干啥就能干啥

1. 获取页面数据
2. 获取Cookies
3. 劫持前端逻辑
4. 发送请求
5. 偷取网站的任意数据
6. 偷取用户的资料
7. 偷取用户的秘钥和登录转态
8. 欺骗用户

防范手段

HEAD ctx.set('X-XSS-Protection',0) //禁止XSS过滤

1. 禁止XSS过滤
2. 启用XSS过滤(通常浏览器是默认的)，如果检测到跨脚本攻击，浏览器将清除页面(删除不安全的部分) mode=block
   启用XSS过滤，如果检测到攻击，浏览器将不再会清除页面，而是阻止页面加载report=(Chromium only)
   =启用XSS过滤，如果检测到跨站脚攻击，浏览器将清除并使用、
   CSP
   内容安全策略(CSP,Content Security Policy)是一个附加的安全层，用于帮助检测和缓解那些类型的攻击，包括跨站脚本(XSS)
   和数据注入等攻击，这些攻击可用于实现从数据窃取到网站破坏或作为恶意软件分发版本等用途
   CSP本质就是建立白名单，开发者明确告诉浏览器那些外部资源可以加载和执行，我们只需要配置规则，如何拦截是由浏览器自己实现的，我们可以通过这种方式来尽量减少XSS攻击

## CSRF

CSRF(Cross Site Request Forgery)，既跨站请求伪造，是一种常见的web攻击，他利用用户以登录的身份，在用户不知情的情况下，以用户的名字完成非法操作

1. 用户登录了站点A，并在本地记录了cookie
2. 在用户没有登录除站点A的情况下(也就是cookie生效的情况下)，访问了恶意攻击者提供引诱危险站点B(B站点需求访问站点A)。
3. 站点A没有做任何CSRF防御

CSRF危害

1. 利用用户登录状态
2. 用户不知情
3. 完成业务请求
4. 盗取用户资金(转账，消费)
5. 冒充用户发帖背锅
6. 损害网站声誉

## 点击劫持--clickjacking

点击劫持是一种视觉欺骗的攻击手段，攻击者将需要攻击的网站通过iframe嵌套方式嵌入自己的网页中，并将iframe设置为透明的，在页面中透露出一个按钮诱导用户点击
通过用于各种网站，使用iframe技术，图片点几进入一个其他网址，导致用户信息泄密

点击劫持防御

X-FRAME-OPTIONS 是一个HTTP响应头，在现代浏览器有一个很好的支持，这个HTTP响应头就是为了防御iframe嵌套的点击劫持攻击

该响应头有三个值可选，分别是

DENY:表示页面不允许通过iframe的方式展示

SAMEORIGIN:表示页面可以在相同域名下通过iframe的方式展示

ALLOW-FRO:表示页面可以在指定来源的iframe中展示

## OS命令注入

os命令注入和sql注入差不多，只不过SQL注入是针对数据库的，而OS命令注入是针对操作系统的，OS命令注入攻击者指通过web应用,执行非法的操作系统命令达到攻击的目的，只要在你让那个调用Shell函数的地方就有存在被攻击的风险，倘若
调用shell时存在疏漏，就可以执行插入非法命令

```
以node.js为例，假如在接口中需要从github下载用户指定的repo  
const exec = require('mz/child_process').exec;  
let params = {/*用户输入的参数*/}  
exec(`git clone ${params.repo} /some/path`)  
如果传入参数是会怎么样  
https://github.com/xx/xx.git && rm -fr /* &&
```

## DDOS

http://www.ruanyifeng.com/blog/2018/06/ddos.html 阮一峰文档说

DDOS不是一种攻击，而是一大类攻击的总称，它有几十张类型，新的攻击方法还不断发明出来，网站运行各个环节，都可以是攻击目标，只要把一个环节攻破，使得整个流程、跑不起来，就得到瘫痪服务的目的

其中，比较常见的是一种攻击是cc攻击，他就是简单粗暴地送来大量的正常请求，超出服务器的最大承受量，导致死机，

比如遭遇cc攻击，最多的时候全世界大概20多个ip地址轮流发出请求，每个地址请求量在每秒200次-300次，我看访问日志的时候，就觉得请求像洪水一样涌来，一眨眼就是一大堆，几分钟的时候，日志文件的体积就大了100MB

